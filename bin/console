#!/usr/bin/env ruby
# frozen_string_literal: true

ENV["BUNDLE_GEMFILE"] ||= File.expand_path("../Gemfile", __dir__)

require "bundler/setup"
require_relative "../lib/clawkit"

Clawkit.load_env
config = Clawkit.load_config
ssh_user = config.fetch("ssh_user", "debian")
hosts = Clawkit.resolve_hosts(config)

host = ARGV[0] || hosts.first
host_display = config.fetch("private_mode", false) ? "[REDACTED]" : host
abort "Error: No host configured." unless host

puts "Connecting to #{ssh_user}@#{host_display}..."
exec "ssh", "#{ssh_user}@#{host}"
